(function(a){a.fn.gridEditor=function(g){var d=this.data("grideditor");if("getHtml"==g){if(d){d.deinit();var e=this.html();d.init();return e}return this.html()}this.each(function(e,d){function p(){y(!0);f.addClass("ge-editing");H();I();n();J();K();z(u)}function x(){f.removeClass("ge-editing");f.find(".ge-content").each(function(){var b=a(this);a.fn.gridEditor.RTEs[b.data("ge-content-type")].deinit(k,b)});f.find(".ge-tools-drawer").remove();f.add(f.find(".column")).add(f.find(".row")).sortable("destroy");
y()}function n(){f.find(".row").each(function(){var b=a(this);if(!b.find("> .ge-tools-drawer").length){var c=a('<div class="ge-tools-drawer" />').prependTo(b);l(c,"Move","ge-move","glyphicon-move");l(c,"Settings","","glyphicon-cog",function(){h.toggle()});k.row_tools.forEach(function(b){l(c,b.title||"",b.className||"",b.iconClass||"glyphicon-wrench",b.on)});l(c,"Remove row","","glyphicon-trash",function(){window.confirm("Delete row?")&&b.slideUp(function(){b.remove()})});l(c,"Add column","ge-add-column",
"glyphicon-plus-sign",function(){b.append(v(3));p()});var h=A(b,k.row_classes).appendTo(c)}})}function J(){f.find(".column").each(function(){var b=a(this);if(!b.find("> .ge-tools-drawer").length){var c=a('<div class="ge-tools-drawer" />').prependTo(b);l(c,"Move","ge-move","glyphicon-move");l(c,"Make column narrower\n(hold shift for min)","ge-decrease-col-width","glyphicon-minus",function(a){var c=k.valid_col_sizes,h=t[u],m=c.indexOf(B(b,h)),m=c[Math.min(c.length-1,Math.max(0,m-1))];a.shiftKey&&(m=
c[0]);C(b,h,Math.max(m,1))});l(c,"Make column wider\n(hold shift for max)","ge-increase-col-width","glyphicon-plus",function(a){var c=k.valid_col_sizes,h=t[u],m=c.indexOf(B(b,h)),m=c[Math.min(c.length-1,Math.max(0,m+1))];a.shiftKey&&(m=c[c.length-1]);C(b,h,Math.min(m,12))});l(c,"Settings","","glyphicon-cog",function(){h.toggle()});k.col_tools.forEach(function(b){l(c,b.title||"",b.className||"",b.iconClass||"glyphicon-wrench",b.on)});l(c,"Remove col","","glyphicon-trash",function(){window.confirm("Delete column?")&&
b.animate({opacity:"hide",width:"hide",height:"hide"},400,function(){b.remove()})});l(c,"Add row","ge-add-row","glyphicon-plus-sign",function(){var c=a('<div class="row" />');b.append(c);c.append(v(6)).append(v(6));p()});var h=A(b,k.col_classes).appendTo(c)}})}function l(b,c,h,m,d){var f=a('<a title="'+c+'" class="'+h+'"><span class="glyphicon '+m+'"></span></a>').appendTo(b);if("function"==typeof d)f.on("click",d);"object"==typeof d&&a.each(d,function(b,a){f.on(b,a)})}function A(b,c){var h=a('<div class="ge-details" />');
a('<input class="ge-id" />').attr("placeholder","id").val(b.attr("id")).attr("title","Set a unique identifier").on("blur",function(){b.attr("id",a(this).val())}).appendTo(h);var d=a('<div class="btn-group" />').appendTo(h);c.forEach(function(c){var h=a('<a class="btn btn-xs btn-default" />').html(c.label).attr("title",c.title?c.title:'Toggle "'+c.label+'" styling').toggleClass("active btn-primary",b.hasClass(c.cssClass)).on("click",function(){h.toggleClass("active btn-primary");b.toggleClass(c.cssClass,
h.hasClass("active"))}).appendTo(d)});return h}function H(){f.find('.column, div[class*="col-"]').each(function(){var b=a(this),c=2,h=D(b);h.length&&(c=h[0].size);var d=b.attr("class");t.forEach(function(a){-1==d.indexOf(a)&&b.addClass(a+c)});b.addClass("column")})}function B(b,a){for(var c=D(b),d=0;d<c.length;d++)if(c[d].colClass==a)return c[d].size;return c.length?c[0].size:null}function D(b){var a=[];t.forEach(function(c){var d=new RegExp(c+"(\\d+)","i");d.test(b.attr("class"))&&a.push({colClass:c,
size:parseInt(d.exec(b.attr("class"))[1])})});return a}function C(b,a,d){var c=(new RegExp("("+a+"(\\d+))","i")).exec(b.attr("class"));c&&parseInt(c[2])!==d?b.switchClass(c[1],a+d,50):b.addClass(a+d)}function K(){function a(a,b){b.placeholder.css({height:b.item.outerHeight()})}f.find(".row").sortable({items:"> .column",connectWith:".ge-canvas .row",handle:"> .ge-tools-drawer .ge-move",start:a,helper:"clone"});f.add(f.find(".column")).sortable({items:"> .row, > .ge-content",connectsWith:".ge-canvas, .ge-canvas .column",
handle:"> .ge-tools-drawer .ge-move",start:a,helper:"clone"})}function v(b){return a("<div/>").addClass(t.map(function(a){return a+b}).join(" ")).append(E().html(a.fn.gridEditor.RTEs[k.content_types[0]].initialContent))}function y(b){k.custom_filter.length&&a.each(k.custom_filter,function(a,d){"string"==typeof d&&(d=window[d]);d(f,b)})}function I(){f.find(".column").each(function(){var b=a(this),c=a();b.children().each(function(){var b=a(this);b.is(".row, .ge-tools-drawer, .ge-content")?F(c):c=c.add(b)});
F(c)})}function F(b){if(b.length){var c=E().insertAfter(b.last());b.appendTo(c);a()}}function E(){return a("<div/>").addClass("ge-content ge-content-type-"+k.content_types[0]).attr("data-ge-content-type",k.content_types[0])}function z(a){u=a;["ge-layout-desktop","ge-layout-tablet","ge-layout-phone"].forEach(function(b,d){f.toggleClass(b,d==a)})}d=a(d);var k=a.extend({new_row_layouts:[[12],[6,6],[4,4,4],[3,3,3,3],[2,2,2,2,2,2],[2,8,2],[4,8],[8,4]],row_classes:[{label:"Example class",cssClass:"example-class"}],
col_classes:[{label:"Example class",cssClass:"example-class"}],col_tools:[],row_tools:[],custom_filter:"",content_types:["tinymce"],valid_col_sizes:[1,2,3,4,5,6,7,8,9,10,11,12],source_textarea:""},g),f,w,G,t=["col-md-","col-sm-","col-xs-"],u=0;if(k.source_textarea){var r=a(k.source_textarea);r.addClass("ge-html-output");var q=r;r.val()&&d.html(r.val())}d.children().length&&!d.find("div.row").length&&(r=d.children(),a('<div class="row"><div class="col-md-12"/></div>').appendTo(d).find(".col-md-12").append(r));
(function(){f=d.addClass("ge-canvas");"undefined"!==typeof q&&q.length||(q=a('<textarea class="ge-html-output"/>').insertBefore(f));w=a('<div class="ge-mainControls" />').insertBefore(q);var b=a('<div class="ge-wrapper ge-top" />').appendTo(w);G=a('<div class="ge-addRowGroup btn-group" />').appendTo(b);a.each(k.new_row_layouts,function(b,c){var d=a('<a class="btn btn-xs btn-primary" />').attr("title","Add row "+c.join("-")).on("click",function(){var b=a('<div class="row" />').appendTo(f);c.forEach(function(a){v(a).appendTo(b)});
p()}).appendTo(G);d.append('<span class="glyphicon glyphicon-plus-sign"/>');c.join(" - ");var e='<div class="row ge-row-icon">';c.forEach(function(a){e+='<div class="column col-xs-'+a+'"/>'});e+="</div>";d.append(e)});var c=a('<div class="dropdown pull-right ge-layout-mode"><button type="button" class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown"><span>Desktop</span></button><ul class="dropdown-menu" role="menu"><li><a data-width="auto" title="Desktop"><span>Desktop</span></a></li><li><a title="Tablet"><span>Tablet</span></li><li><a title="Phone"><span>Phone</span></a></li></ul></div>').on("click",
"a",function(){var b=a(this);z(b.closest("li").index());var d=c.find("button");d.find("span").remove();d.append(b.find("span").clone())}).appendTo(b),e=a('<div class="btn-group pull-right"/>').appendTo(b),g=a('<button title="Edit Source Code" type="button" class="btn btn-xs btn-primary gm-edit-mode"><span class="glyphicon glyphicon-chevron-left"></span><span class="glyphicon glyphicon-chevron-right"></span></button>').on("click",function(){g.hasClass("active")?(f.empty().html(q.val()).show(),p(),
q.hide()):(x(),q.height(.8*a(window).height()).val(f.html()).show(),f.hide());g.toggleClass("active btn-danger")}).appendTo(e),l=a('<button title="Preview" type="button" class="btn btn-xs btn-primary gm-preview"><span class="glyphicon glyphicon-eye-open"></span></button>').on("mouseenter",function(){f.removeClass("ge-editing")}).on("click",function(){l.toggleClass("active btn-danger").trigger("mouseleave")}).on("mouseleave",function(){l.hasClass("active")||f.addClass("ge-editing")}).appendTo(e),n=
a(window);n.on("scroll",function(a){n.scrollTop()>w.offset().top&&n.scrollTop()<f.offset().top+f.height()?b.hasClass("ge-top")&&b.css({left:b.offset().left,width:b.outerWidth()}).removeClass("ge-top").addClass("ge-fixed"):b.hasClass("ge-fixed")&&b.css({left:"",width:""}).removeClass("ge-fixed").addClass("ge-top")});f.on("click",".ge-content",function(b){(b=a.fn.gridEditor.RTEs[a(this).data("ge-content-type")])&&b.init(k,a(this))})})();p();d.data("grideditor",{init:p,deinit:x})});return this};a.fn.gridEditor.RTEs=
{}})(jQuery);
(function(){$.fn.gridEditor.RTEs.ckeditor={init:function(a,g){window.CKEDITOR||console.error("CKEditor not available! Make sure you loaded the ckeditor and jquery adapter js files.");var d=this;g.each(function(){var e=$(this);if(!e.hasClass("active")){e.html()==d.initialContent&&e.html("&nbsp;");e.addClass("active").attr("contenteditable","true");var g=$.extend({},a.ckeditor&&a.ckeditor.config?a.ckeditor.config:{},{on:{instanceReady:function(d){try{var e=a.ckeditor.config.on.instanceReady}catch(L){}e&&e.call(this,
d);n.focus()}}}),n=CKEDITOR.inline(e.get(0),g)}})},deinit:function(a,g){g.filter(".active").each(function(){var a=$(this);$.each(CKEDITOR.instances,function(a,d){d.destroy()});a.removeClass("active cke_focus").removeAttr("id").removeAttr("style").removeAttr("spellcheck").removeAttr("contenteditable")})},initialContent:"<p>Lorem initius... </p>"}})();
(function(){$.fn.gridEditor.RTEs.summernote={init:function(a,g){jQuery().summernote||console.error("Summernote not available! Make sure you loaded the Summernote js file.");var d=this;g.each(function(){var e=$(this);if(!e.hasClass("active")){e.html()==d.initialContent&&e.html("");e.addClass("active");var g=$.extend({},a.summernote&&a.summernote.config?a.summernote.config:{},{tabsize:2,airMode:!0,callbacks:{onInit:function(){try{var d=a.summernote.config.callbacks.onInit}catch(p){}d&&d.call(this);
e.summernote("focus")}}});e.summernote(g)}})},deinit:function(a,g){g.filter(".active").each(function(){var a=$(this);a.summernote("destroy");a.removeClass("active").removeAttr("id").removeAttr("style").removeAttr("spellcheck")})},initialContent:"<p>Lorem ipsum dolores</p>"}})();
(function(){$.fn.gridEditor.RTEs.tinymce={init:function(a,g){window.tinymce||console.error("tinyMCE not available! Make sure you loaded the tinyMCE js file.");g.tinymce||console.error("tinyMCE jquery integration not available! Make sure you loaded the jquery integration plugin.");var d=this;g.each(function(){var e=$(this);if(!e.hasClass("active")){e.html()==d.initialContent&&e.html("");e.addClass("active");var g=$.extend({},a.tinymce&&a.tinymce.config?a.tinymce.config:{},{inline:!0,oninit:function(d){$("#"+
d.settings.id).focus();try{var e=a.tinymce.config.oninit}catch(M){}e&&e.call(this)}});e.tinymce(g)}})},deinit:function(a,g){g.filter(".active").each(function(){var a=$(this),e=a.tinymce();e&&e.remove();a.removeClass("active").removeAttr("id").removeAttr("style").removeAttr("spellcheck")})},initialContent:"<p>Lorem ipsum dolores</p>"}})();
